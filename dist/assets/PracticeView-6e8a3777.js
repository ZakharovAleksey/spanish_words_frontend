import{_ as ne,g as F,C as v,a as M,k as D,h as y,W as L,i as U,M as S,L as N,j as V,l as R,m as G,n as ie,p as ce,q as ae,r as n,o as i,s as C,b as t,w as s,t as _e,F as W,x as b,c as h,d as g,f as de,v as ue,y as p,z as K,A as c,B as k,e as he,D as ge,E as me,G as pe}from"./index-875d86c2.js";const fe={data(){return{is_parameters_select_disabled:!1,selected_gsheet:null,gsheets:[],gsheets_loading:!0,selected_category:null,categories:[],categories_loading:!1,selected_category_key:null,category_keys:[],category_key_loading:!1,selected_number:F[0],numbers:F,check_by_typing:!1,languages:[v.ENGLISH,v.SPANISH],selected_language:v.ENGLISH,words:{},forgotten_words:[],words_loading:!1,word_to_translation_pairs:new Map,words_queue:[],current_word_id:0,current_word_to_check:null,current_user_input:null,post_validation_lock:!1,is_user_input_correct:!0,current_error_message:"",current_message:"",success_percent:0,overlay:!1,is_lesson_complete:!1,lesson_icon:null,lesson_color:null,window:{width:0,height:0},top_class:""}},created(){window.addEventListener("resize",this.handleResize),this.handleResize()},async beforeMount(){M.get(`${D}/api/spreadsheet/titles/`).then(o=>this.gsheets=o.data).catch(o=>this.showErrorToast(o)).finally(()=>this.gsheets_loading=!1)},watch:{selected_gsheet:function(){this.selected_category=null,this.selected_category_key=null,this.getThemes()},selected_category:function(){this.selected_category_key=null,this.getSubThemes()},window:{handler(){this.top_class=this.window.width<600?"flex-column":""},deep:!0}},methods:{async getThemes(){this.gsheets.length!==0&&this.gsheets.includes(this.selected_gsheet)&&(this.categories_loading=!0,M.get(`${D}/api/worksheet/columns/`,{params:{title:this.selected_gsheet}}).then(o=>this.categories=o.data).catch(o=>this.showErrorToast(o)).finally(()=>this.categories_loading=!1))},async getSubThemes(){if(this.gsheets.length===0||this.categories.length===0)return;let o=[];Object.entries(this.categories).forEach(([l,a])=>{o.push(a.id)}),o.includes(this.selected_category)&&(this.category_key_loading=!0,M.get(`${D}/api/worksheet/colums/unique_values/`,{params:{title:this.selected_gsheet,column_id:this.selected_category}}).then(l=>this.category_keys=l.data).catch(l=>this.showErrorToast(l)).finally(()=>this.category_key_loading=!1))},async getWords(){this.isPreRequestRequirementsSatisfied(!0,!0,!0)&&(this.cleanUpLessonData(),this.is_parameters_select_disabled=!0,this.words_loading=!0,M.get(`${D}/api/worksheet/random_values/`,{params:{title:this.selected_gsheet,filter_column_id:this.selected_category,template:this.selected_category_key.join("|"),column_ids:"0,1",count:this.selected_number}}).then(o=>{for(const[e,_]of Object.entries(o.data)){const d=parseInt(e)===0?v.SPANISH:v.ENGLISH;this.words[d]=_.map(m=>({word:m,color:y.GOOD,icon:"mdi-emoticon"}))}const l=this.selected_language===v.SPANISH?0:1,a=l===1?0:1,x=o.data[l].length;for(let e=0;e<x;++e)this.word_to_translation_pairs.set(o.data[l][e],o.data[a][e]);this.check_by_typing||(this.words_queue=[...o.data[l]],this.forgotten_words=[...o.data[l]],this.current_word_to_check=this.words_queue[this.current_word_id])}).catch(o=>this.showErrorToast(o)).finally(()=>this.words_loading=!1))},updateWordStatus(o){const l=o.word,a=this.forgotten_words.indexOf(l);a!==-1?this.forgotten_words.splice(a,1):this.forgotten_words.push(l),o.color=o.color===y.GOOD?y.BAD:y.GOOD,o.icon=o.icon===L.REMEMBERED?L.FORGOTTEN:L.REMEMBERED},onCompleteClick(){const o=this.word_to_translation_pairs.size-this.forgotten_words.length,l=this.word_to_translation_pairs.size;this.success_percent=(o/l).toFixed(1)*U;const a=this.success_percent/U*100,x=this.chooseLessonIcons(a);this.lesson_icon=x.icon,this.lesson_color=x.color,this.overlay=!0},onLessonComplete(){this.overlay=!this.overlay,this.is_lesson_complete=!0,this.is_parameters_select_disabled=!1},generateUserMessageOnLessonComplete(){const o=this.success_percent/U*100,l=`You remember ${o}% of the words.`;return o>S.GOOD?l+N.GOOD:o>S.MEDIUM?l+N.MEDIUM:l+N.BAD},isPreRequestRequirementsSatisfied(o=!1,l=!1,a=!1){return o&&this.selected_gsheet===null?(V().info(R+"google sheet"),!1):l&&this.selected_category===null?(V().info(R+"words filtering key"),!1):a&&(this.selected_category_key===null||this.selected_category_key.length===0)?(V().info(R+"words category"),!1):!0},cleanUpLessonData(){this.words={},this.forgotten_words=[],this.word_to_translation_pairs.clear(),this.is_lesson_complete=!1,this.words_queue=[],this.current_word_id=0,this.current_word_to_check=null,this.current_user_input=null,this.post_validation_lock=!1,this.is_user_input_correct=!0,this.current_error_message="",this.current_message=""},chooseLessonIcons(o){return o>S.GOOD?{icon:G.GOOD,color:y.GOOD}:o>S.MEDIUM?{icon:G.MEDIUM,color:y.MEDIUM}:{icon:G.BAD,color:y.BAD}},transformWord(o){return o.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"")},checkTranslation(){const o=this.word_to_translation_pairs.get(this.current_word_to_check);if(this.is_user_input_correct=this.transformWord(this.current_user_input)===this.transformWord(o),this.is_user_input_correct){const l=this.forgotten_words.indexOf(this.current_word_to_check);l!==-1&&this.forgotten_words.splice(l,1)}this.post_validation_lock=!0,this.is_user_input_correct?this.current_message="Great job!":this.current_error_message=`Sorry, expected translation: ${o}`},getNextWord(){if(!this.post_validation_lock){this.checkTranslation();return}if(this.current_word_id===this.words_queue.length-1){this.onCompleteClick();return}this.current_word_id++,this.current_word_to_check=this.words_queue[this.current_word_id],this.current_user_input="",this.is_user_input_correct="",this.current_error_message="",this.current_message="",this.is_user_input_correct=!0,this.post_validation_lock=!1},showErrorToast(o){console.log(o),o.response.status===401?(V().info(ie),setTimeout(()=>{this.$router.push("/login")},ce)):V().error(ae)},destroyed(){window.removeEventListener("resize",this.handleResize)},handleResize(){this.window.width=window.innerWidth,this.window.height=window.innerHeight}}},z=o=>(me("data-v-cb0bdef0"),o=o(),pe(),o),ye={key:1},we={class:"my-2 text-h6"},ve=z(()=>c("thead",null,[c("tr",null,[c("th",{class:"text-center"}," Original "),c("th",{class:"text-center"}," Translation ")])],-1)),be={class:"text-center"},ke={class:"text-center"},xe=z(()=>c("div",{class:"d-flex justify-center mt-auto text-h5"},"Lesson complete!",-1)),Ve={class:"d-flex flex-column align-center"},Ce={class:"text-h2 mt-5"},Oe=z(()=>c("span",{class:"text-h6 ml-n3"},"/5",-1)),Ee={class:"px-3 text-subtitle-1 text-center"},Me=z(()=>c("br",null,null,-1));function De(o,l,a,x,e,_){const d=n("v-icon"),m=n("v-tooltip"),Y=n("v-combobox"),w=n("v-list-item"),q=n("v-autocomplete"),B=n("v-select"),X=n("v-checkbox"),J=n("v-list"),u=n("v-row"),O=n("v-btn"),T=n("v-col"),I=n("v-card-title"),Q=n("v-alert"),j=n("v-card-item"),f=n("v-card"),P=n("v-progress-circular"),Z=n("v-chip"),E=n("v-card-text"),$=n("v-progress-linear"),A=n("v-text-field"),ee=n("v-form"),H=n("v-card-actions"),te=n("v-container"),se=n("v-card-subtitle"),oe=n("v-table"),le=n("v-rating"),re=n("v-overlay");return i(),C(W,null,[t(u,{class:_e(e.top_class)},{default:s(()=>[t(T,{class:"grow d-flex flex-column flex-nowrap",xs:"12",md:"4"},{default:s(()=>[t(u,{cols:"12",align:"end",justify:"center"},{default:s(()=>[t(J,null,{default:s(()=>[t(w,null,{prepend:s(()=>[t(m,{text:"Select the google sheet to retrieve words",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-google-spreadsheet",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(Y,{label:"Google sheet",modelValue:e.selected_gsheet,"onUpdate:modelValue":l[0]||(l[0]=r=>e.selected_gsheet=r),items:e.gsheets,loading:e.gsheets_loading,clearable:!0,"append-icon":"",disabled:e.is_parameters_select_disabled,"hide-details":!0,variant:"outlined",class:"my-2"},null,8,["modelValue","items","loading","disabled"])]),_:1}),t(w,null,{prepend:s(()=>[t(m,{text:"Column with the words categories",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-shape-outline",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(q,{label:"Google sheet base column",modelValue:e.selected_category,"onUpdate:modelValue":l[1]||(l[1]=r=>e.selected_category=r),items:e.categories,"item-title":"text","item-value":"id",loading:e.categories_loading,clearable:!0,"append-icon":"",disabled:e.is_parameters_select_disabled,"hide-details":!0,variant:"outlined",class:"my-2"},null,8,["modelValue","items","loading","disabled"])]),_:1}),t(w,null,{prepend:s(()=>[t(m,{text:"Category for the words filtering",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-shape-plus",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(q,{label:"Words categories",modelValue:e.selected_category_key,"onUpdate:modelValue":l[2]||(l[2]=r=>e.selected_category_key=r),items:e.category_keys,loading:e.category_key_loading,clearable:!0,"append-icon":"",disabled:e.is_parameters_select_disabled,multiple:"","hide-details":"true",variant:"outlined",class:"my-2"},null,8,["modelValue","items","loading","disabled"])]),_:1}),t(w,null,{prepend:s(()=>[t(m,{text:"Original language to translate from",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-translate",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(B,{label:"Original language",modelValue:e.selected_language,"onUpdate:modelValue":l[3]||(l[3]=r=>e.selected_language=r),items:e.languages,"append-icon":"",disabled:e.is_parameters_select_disabled,"hide-details":!0,variant:"outlined",class:"my-2"},null,8,["modelValue","items","disabled"])]),_:1}),t(w,null,{prepend:s(()=>[t(m,{text:"Number of words to repeat",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-counter",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(B,{label:"Number of words to repeat",modelValue:e.selected_number,"onUpdate:modelValue":l[4]||(l[4]=r=>e.selected_number=r),items:e.numbers,disabled:e.is_parameters_select_disabled,variant:"outlined","hide-details":!0,class:"my-2"},null,8,["modelValue","items","disabled"])]),_:1}),t(w,null,{prepend:s(()=>[t(m,{text:"Enable, if you prefer repeat words without typing their translation",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-draw",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(X,{label:"Check words translation",modelValue:e.check_by_typing,"onUpdate:modelValue":l[5]||(l[5]=r=>e.check_by_typing=r),disabled:e.is_parameters_select_disabled,variant:"outlined","hide-details":!0,class:"my-2"},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),t(u,{cols:"12",align:"end",justify:"center"},{default:s(()=>[t(O,{rounded:"lg",size:"large",class:"text-uppercase my-1 my-button",text:"start",onClick:_.getWords},null,8,["onClick"])]),_:1})]),_:1}),t(T,{class:"grow d-flex flex-column flex-nowrap",xs:"12",md:"7"},{default:s(()=>[t(u,{cols:"12"},{default:s(()=>[e.is_lesson_complete?p("",!0):(i(),h(f,{key:0,elevation:"0",width:"100%"},{default:s(()=>[t(j,null,{default:s(()=>[t(I,null,{default:s(()=>[g(" Words to repeat ")]),_:1}),de(t(Q,{"border-color":"blue",title:"Note",text:"Click on the words, translations of which you do not remember.",border:"start",class:"text-subtitle-2 mt-6",closable:"","close-icon":"mdi-close-circle-outline",icon:"mdi-cursor-default-click-outline"},null,512),[[ue,Object.keys(e.words).length!==0&&e.check_by_typing]])]),_:1})]),_:1})),!e.is_lesson_complete&&e.check_by_typing?(i(),h(f,{key:1,elevation:"0",width:"100%"},{default:s(()=>[t(E,null,{default:s(()=>[t(T,{cols:"12"},{default:s(()=>[t(u,{cols:"12",justify:"center"},{default:s(()=>[e.words_loading?(i(),h(P,{key:0,class:"align-center justify-center",indeterminate:""})):(i(!0),C(W,{key:1},K(e.words[e.selected_language],r=>(i(),h(Z,{"prepend-icon":r.icon,class:"ma-1",color:r.color,size:"large",onClick:Se=>_.updateWordStatus(r)},{default:s(()=>[g(k(r.word),1)]),_:2},1032,["prepend-icon","color","onClick"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})):p("",!0),!e.is_lesson_complete&&!e.check_by_typing?(i(),h(f,{key:2,elevation:"0",width:"100%"},{default:s(()=>[t(E,null,{default:s(()=>[t(te,null,{default:s(()=>[e.words_loading?(i(),h(u,{key:0,cols:"12",justify:"center"},{default:s(()=>[t(P,{class:"align-center justify-center",indeterminate:""})]),_:1})):p("",!0),!e.words_loading&&Object.keys(e.words).length!==0?(i(),C("div",ye,[t(u,{cols:"12","align-content":"center"},{default:s(()=>[c("p",we,"Your progress: "+k(Math.round(e.current_word_id/e.words_queue.length*100))+" %",1),t($,{modelValue:e.current_word_id,"onUpdate:modelValue":l[6]||(l[6]=r=>e.current_word_id=r),max:e.words_queue.length,height:12,rounded:"",class:"pa-0 mb-10",color:"green"},null,8,["modelValue","max"])]),_:1}),t(u,{cols:"12",justify:"center",align:"center"},{default:s(()=>[t(f,{rounded:"lg",class:"pa-5",width:"400"},{default:s(()=>[t(A,{label:"Original",variant:"outlined",modelValue:e.current_word_to_check,"onUpdate:modelValue":l[7]||(l[7]=r=>e.current_word_to_check=r),readonly:!0},null,8,["modelValue"]),t(ee,{"validate-on":"submit lazy",onSubmit:he(_.checkTranslation,["prevent"])},{default:s(()=>[t(A,{modelValue:e.current_user_input,"onUpdate:modelValue":l[8]||(l[8]=r=>e.current_user_input=r),"persistent-hint":!0,label:"Translation",variant:"outlined",onKeyup:ge(_.checkTranslation,["enter"]),readonly:e.post_validation_lock,error:!e.is_user_input_correct,"error-messages":e.current_error_message,messages:e.current_message},null,8,["modelValue","onKeyup","readonly","error","error-messages","messages"])]),_:1},8,["onSubmit"]),t(H,{class:"align-center justify-center"},{default:s(()=>[t(O,{rounded:"lg",size:"large",class:"text-uppercase mt-1 my-button",text:"NEXT",onClick:_.getNextWord,variant:"elevated"},null,8,["onClick"])]),_:1})]),_:1})]),_:1})])):p("",!0)]),_:1})]),_:1})]),_:1})):p("",!0),e.is_lesson_complete&&e.forgotten_words.length!==0?(i(),h(f,{key:3,elevation:"0",class:"w-100"},{default:s(()=>[t(j,null,{default:s(()=>[t(I,null,{default:s(()=>[g(" Forgotten words ")]),_:1}),t(se,null,{default:s(()=>[g(" Here are words for you to repeat to get all five stars next time! ")]),_:1})]),_:1})]),_:1})):p("",!0),e.is_lesson_complete&&e.forgotten_words.length!==0?(i(),h(f,{key:4,elevation:"0",class:"w-100","max-height":"400px"},{default:s(()=>[t(E,null,{default:s(()=>[t(oe,{"fixed-header":!0,height:"300px"},{default:s(()=>[ve,c("tbody",null,[(i(!0),C(W,null,K(e.forgotten_words,r=>(i(),C("tr",null,[c("td",be,k(r),1),c("td",ke,k(e.word_to_translation_pairs.get(r)),1)]))),256))])]),_:1})]),_:1})]),_:1})):p("",!0)]),_:1}),t(u,{cols:"12",align:"end",justify:"center"},{default:s(()=>[!e.is_lesson_complete&&Object.keys(e.words).length!==0?(i(),h(O,{key:0,rounded:"lg",size:"large",class:"text-uppercase my-1 my-button",onClick:_.onCompleteClick},{default:s(()=>[g("complete")]),_:1},8,["onClick"])):p("",!0)]),_:1})]),_:1})]),_:1},8,["class"]),t(re,{modelValue:e.overlay,"onUpdate:modelValue":l[10]||(l[10]=r=>e.overlay=r),contained:!0,class:"align-center justify-center"},{default:s(()=>[t(f,{rounded:"lg",width:"360"},{default:s(()=>[t(j,null,{default:s(()=>[t(I,null,{default:s(()=>[xe]),_:1})]),_:1}),t(E,null,{default:s(()=>[c("div",Ve,[t(d,{icon:e.lesson_icon,style:{"font-size":"250px"},color:e.lesson_color},null,8,["icon","color"]),c("div",Ce,[g(k(e.success_percent)+" ",1),Oe]),t(le,{modelValue:e.success_percent,"onUpdate:modelValue":l[9]||(l[9]=r=>e.success_percent=r),color:"yellow-darken-3","half-increments":!0,readonly:!0},null,8,["modelValue"]),c("p",Ee,[g(" Great job! "),Me,g(" "+k(_.generateUserMessageOnLessonComplete()),1)])])]),_:1}),t(H,{class:"align-center justify-center"},{default:s(()=>[t(O,{onClick:_.onLessonComplete,class:"text-uppercase my-1 my-button",rounded:"lg",size:"large",variant:"elevated"},{default:s(()=>[g("done")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Te=ne(fe,[["render",De],["__scopeId","data-v-cb0bdef0"]]);export{Te as default};
