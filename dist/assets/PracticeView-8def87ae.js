import{_ as re,g as K,C as w,a as M,k as S,h as y,W as N,i as z,M as E,L as q,j as V,l as G,m as R,n as ne,p as ie,q as ae,r as n,o as i,s as C,b as t,w as s,F as W,t as b,c as g,d as u,x as p,y as Y,z as a,A as k,e as ce,B as _e,D as ue,E as de}from"./index-f9aef279.js";const he={data(){return{is_parameters_select_disabled:!1,selected_gsheet:null,gsheets:[],gsheets_loading:!0,selected_category:null,categories:[],categories_loading:!1,selected_category_key:null,category_keys:[],category_key_loading:!1,selected_number:K[0],numbers:K,check_by_typing:!0,languages:[w.ENGLISH,w.SPANISH],selected_language:w.ENGLISH,words:{},forgotten_words:[],words_loading:!1,word_to_translation_pairs:new Map,words_queue:[],current_word_id:0,current_word_to_check:null,current_user_input:null,post_validation_lock:!1,is_user_input_correct:!0,current_error_message:"",current_message:"",success_percent:0,overlay:!1,is_lesson_complete:!1,lesson_icon:null,lesson_color:null}},async beforeMount(){M.get(`${S}/api/spreadsheet/titles/`).then(o=>this.gsheets=o.data).catch(o=>this.showErrorToast(o)).finally(()=>this.gsheets_loading=!1)},watch:{selected_gsheet:function(){this.selected_category=null,this.selected_category_key=null,this.getThemes()},selected_category:function(){this.selected_category_key=null,this.getSubThemes()}},methods:{async getThemes(){this.gsheets.length!==0&&this.gsheets.includes(this.selected_gsheet)&&(this.categories_loading=!0,M.get(`${S}/api/worksheet/columns/`,{params:{title:this.selected_gsheet}}).then(o=>this.categories=o.data).catch(o=>this.showErrorToast(o)).finally(()=>this.categories_loading=!1))},async getSubThemes(){if(this.gsheets.length===0||this.categories.length===0)return;let o=[];Object.entries(this.categories).forEach(([l,c])=>{o.push(c.id)}),o.includes(this.selected_category)&&(this.category_key_loading=!0,M.get(`${S}/api/worksheet/colums/unique_values/`,{params:{title:this.selected_gsheet,column_id:this.selected_category}}).then(l=>this.category_keys=l.data).catch(l=>this.showErrorToast(l)).finally(()=>this.category_key_loading=!1))},async getWords(){this.isPreRequestRequirementsSatisfied(!0,!0,!0)&&(this.cleanUpLessonData(),this.is_parameters_select_disabled=!0,this.words_loading=!0,M.get(`${S}/api/worksheet/random_values/`,{params:{title:this.selected_gsheet,filter_column_id:this.selected_category,template:this.selected_category_key.join("|"),column_ids:"0,1",count:this.selected_number}}).then(o=>{for(const[e,_]of Object.entries(o.data)){const d=parseInt(e)===0?w.SPANISH:w.ENGLISH;this.words[d]=_.map(m=>({word:m,color:y.GOOD,icon:"mdi-emoticon"}))}const l=this.selected_language===w.SPANISH?0:1,c=l===1?0:1,x=o.data[l].length;for(let e=0;e<x;++e)this.word_to_translation_pairs.set(o.data[l][e],o.data[c][e]);this.check_by_typing||(this.words_queue=[...o.data[l]],this.forgotten_words=[...o.data[l]],this.current_word_to_check=this.words_queue[this.current_word_id])}).catch(o=>this.showErrorToast(o)).finally(()=>this.words_loading=!1))},updateWordStatus(o){const l=o.word,c=this.forgotten_words.indexOf(l);c!==-1?this.forgotten_words.splice(c,1):this.forgotten_words.push(l),o.color=o.color===y.GOOD?y.BAD:y.GOOD,o.icon=o.icon===N.REMEMBERED?N.FORGOTTEN:N.REMEMBERED},onCompleteClick(){const o=this.word_to_translation_pairs.size-this.forgotten_words.length,l=this.word_to_translation_pairs.size;this.success_percent=(o/l).toFixed(1)*z;const c=this.success_percent/z*100,x=this.chooseLessonIcons(c);this.lesson_icon=x.icon,this.lesson_color=x.color,this.overlay=!0},onLessonComplete(){this.overlay=!this.overlay,this.is_lesson_complete=!0,this.is_parameters_select_disabled=!1},generateUserMessageOnLessonComplete(){const o=this.success_percent/z*100,l=`You remember ${o}% of the words.`;return o>E.GOOD?l+q.GOOD:o>E.MEDIUM?l+q.MEDIUM:l+q.BAD},isPreRequestRequirementsSatisfied(o=!1,l=!1,c=!1){return o&&this.selected_gsheet===null?(V().info(G+"google sheet"),!1):l&&this.selected_category===null?(V().info(G+"words filtering key"),!1):c&&(this.selected_category_key===null||this.selected_category_key.length===0)?(V().info(G+"words category"),!1):!0},cleanUpLessonData(){this.words={},this.forgotten_words=[],this.word_to_translation_pairs.clear(),this.is_lesson_complete=!1,this.words_queue=[],this.current_word_id=0,this.current_word_to_check=null,this.current_user_input=null,this.post_validation_lock=!1,this.is_user_input_correct=!0,this.current_error_message="",this.current_message=""},chooseLessonIcons(o){return o>E.GOOD?{icon:R.GOOD,color:y.GOOD}:o>E.MEDIUM?{icon:R.MEDIUM,color:y.MEDIUM}:{icon:R.BAD,color:y.BAD}},transformWord(o){return o.toLowerCase().trim().normalize("NFD").replace(/[\u0300-\u036f]/g,"")},checkTranslation(){const o=this.word_to_translation_pairs.get(this.current_word_to_check);if(this.is_user_input_correct=this.transformWord(this.current_user_input)===this.transformWord(o),this.is_user_input_correct){const l=this.forgotten_words.indexOf(this.current_word_to_check);l!==-1&&this.forgotten_words.splice(l,1)}this.post_validation_lock=!0,this.is_user_input_correct?this.current_message="Great job!":this.current_error_message=`Sorry, expected translation: ${o}`},getNextWord(){if(!this.post_validation_lock){this.checkTranslation();return}if(this.current_word_id===this.words_queue.length-1){this.onCompleteClick();return}this.current_word_id++,this.current_word_to_check=this.words_queue[this.current_word_id],this.current_user_input="",this.is_user_input_correct="",this.current_error_message="",this.current_message="",this.is_user_input_correct=!0,this.post_validation_lock=!1},showErrorToast(o){console.log(o),o.response.status===401?(V().info(ne),setTimeout(()=>{this.$router.push("/login")},ie)):V().error(ae)}}},T=o=>(ue("data-v-4938aa45"),o=o(),de(),o),ge={key:1},me={class:"my-2 text-h6"},pe=T(()=>a("thead",null,[a("tr",null,[a("th",{class:"text-center"}," Original "),a("th",{class:"text-center"}," Translation ")])],-1)),fe={class:"text-center"},ye={class:"text-center"},ve=T(()=>a("div",{class:"d-flex justify-center mt-auto text-h5"},"Lesson complete!",-1)),we={class:"d-flex flex-column align-center"},be={class:"text-h2 mt-5"},ke=T(()=>a("span",{class:"text-h6 ml-n3"},"/5",-1)),xe={class:"px-3 text-subtitle-1 text-center"},Ve=T(()=>a("br",null,null,-1));function Ce(o,l,c,x,e,_){const d=n("v-icon"),m=n("v-tooltip"),B=n("v-combobox"),v=n("v-list-item"),I=n("v-autocomplete"),X=n("v-checkbox"),J=n("v-list"),h=n("v-row"),O=n("v-btn"),U=n("v-col"),Q=n("v-divider"),j=n("v-card-title"),P=n("v-card-subtitle"),L=n("v-card-item"),f=n("v-card"),A=n("v-progress-circular"),Z=n("v-chip"),D=n("v-card-text"),$=n("v-progress-linear"),H=n("v-text-field"),ee=n("v-form"),F=n("v-card-actions"),te=n("v-container"),se=n("v-table"),oe=n("v-rating"),le=n("v-overlay");return i(),C(W,null,[t(h,null,{default:s(()=>[t(U,{class:"grow d-flex flex-column flex-nowrap",sm:"12",md:"4"},{default:s(()=>[t(h,{cols:"12",align:"end",justify:"center"},{default:s(()=>[t(J,null,{default:s(()=>[t(v,null,{prepend:s(()=>[t(m,{text:"Select the google sheet to retrieve words",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-google-spreadsheet",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(B,{label:"Choose the google sheet...",modelValue:e.selected_gsheet,"onUpdate:modelValue":l[0]||(l[0]=r=>e.selected_gsheet=r),items:e.gsheets,loading:e.gsheets_loading,clearable:!0,"append-icon":"",disabled:e.is_parameters_select_disabled,"hide-details":!0,variant:"outlined",class:"my-2"},null,8,["modelValue","items","loading","disabled"])]),_:1}),t(v,null,{prepend:s(()=>[t(m,{text:"Category for further words filtering",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-shape-outline",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(I,{label:"Choose filtering category...",modelValue:e.selected_category,"onUpdate:modelValue":l[1]||(l[1]=r=>e.selected_category=r),items:e.categories,"item-title":"text","item-value":"id",loading:e.categories_loading,clearable:!0,"append-icon":"",disabled:e.is_parameters_select_disabled,"hide-details":!0,variant:"outlined",class:"my-2"},null,8,["modelValue","items","loading","disabled"])]),_:1}),t(v,null,{prepend:s(()=>[t(m,{text:"Sub-category for further words filtering",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-shape-plus",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(I,{label:"Choose the sub-category...",modelValue:e.selected_category_key,"onUpdate:modelValue":l[2]||(l[2]=r=>e.selected_category_key=r),items:e.category_keys,loading:e.category_key_loading,clearable:!0,"append-icon":"",disabled:e.is_parameters_select_disabled,multiple:"","hide-details":"true",variant:"outlined",class:"my-2"},null,8,["modelValue","items","loading","disabled"])]),_:1}),t(v,null,{prepend:s(()=>[t(m,{text:"Original language to translate from",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-translate",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(I,{label:"Choose the original language...",modelValue:e.selected_language,"onUpdate:modelValue":l[3]||(l[3]=r=>e.selected_language=r),items:e.languages,clearable:!0,"append-icon":"",disabled:e.is_parameters_select_disabled,"hide-details":!0,variant:"outlined",class:"my-2"},null,8,["modelValue","items","disabled"])]),_:1}),t(v,null,{prepend:s(()=>[t(m,{text:"Number of words to repeat",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-counter",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(B,{label:"Select the number of words to repeat...",modelValue:e.selected_number,"onUpdate:modelValue":l[4]||(l[4]=r=>e.selected_number=r),items:e.numbers,clearable:!0,disabled:e.is_parameters_select_disabled,variant:"outlined","hide-details":!0,class:"my-2"},null,8,["modelValue","items","disabled"])]),_:1}),t(v,null,{prepend:s(()=>[t(m,{text:"Disable if you want the app to check each word translation you type",location:"bottom"},{activator:s(({props:r})=>[t(d,b({icon:"mdi-draw",size:"x-large"},r),null,16)]),_:1})]),default:s(()=>[t(X,{label:"Do manual word translations check",modelValue:e.check_by_typing,"onUpdate:modelValue":l[5]||(l[5]=r=>e.check_by_typing=r),disabled:e.is_parameters_select_disabled,variant:"outlined","hide-details":!0,class:"my-2"},null,8,["modelValue","disabled"])]),_:1})]),_:1})]),_:1}),t(h,{cols:"12",align:"end",justify:"center"},{default:s(()=>[t(O,{rounded:"lg",size:"large",class:"text-uppercase my-1 my-button",text:"start",onClick:_.getWords},null,8,["onClick"])]),_:1})]),_:1}),t(Q,{vertical:!0}),t(U,{class:"grow d-flex flex-column flex-nowrap",sm:"12",md:"7"},{default:s(()=>[t(h,{cols:"12"},{default:s(()=>[e.is_lesson_complete?p("",!0):(i(),g(f,{key:0,elevation:"0",width:"100%"},{default:s(()=>[t(L,null,{default:s(()=>[t(j,null,{default:s(()=>[u(" Words to repeat ")]),_:1}),t(P,null,{default:s(()=>[u(" Please, click on the words that you don't remember, so you can see their translation, after completing the practice. ")]),_:1})]),_:1})]),_:1})),!e.is_lesson_complete&&e.check_by_typing?(i(),g(f,{key:1,elevation:"0",width:"100%"},{default:s(()=>[t(D,null,{default:s(()=>[t(U,{cols:"12"},{default:s(()=>[t(h,{cols:"12",justify:"center"},{default:s(()=>[e.words_loading?(i(),g(A,{key:0,class:"align-center justify-center",indeterminate:""})):(i(!0),C(W,{key:1},Y(e.words[e.selected_language],r=>(i(),g(Z,{"prepend-icon":r.icon,class:"ma-1",color:r.color,size:"large",onClick:Oe=>_.updateWordStatus(r)},{default:s(()=>[u(k(r.word),1)]),_:2},1032,["prepend-icon","color","onClick"]))),256))]),_:1})]),_:1})]),_:1})]),_:1})):p("",!0),!e.is_lesson_complete&&!e.check_by_typing?(i(),g(f,{key:2,elevation:"0",width:"100%"},{default:s(()=>[t(D,null,{default:s(()=>[t(te,null,{default:s(()=>[e.words_loading?(i(),g(h,{key:0,cols:"12",justify:"center"},{default:s(()=>[t(A,{class:"align-center justify-center",indeterminate:""})]),_:1})):p("",!0),!e.words_loading&&Object.keys(e.words).length!==0?(i(),C("div",ge,[t(h,{cols:"12","align-content":"center"},{default:s(()=>[a("p",me,"Your progress: "+k(Math.round(e.current_word_id/e.words_queue.length*100))+" %",1),t($,{modelValue:e.current_word_id,"onUpdate:modelValue":l[6]||(l[6]=r=>e.current_word_id=r),max:e.words_queue.length,height:12,rounded:"",class:"pa-0 mb-10",color:"green"},null,8,["modelValue","max"])]),_:1}),t(h,{cols:"12",justify:"center",align:"center"},{default:s(()=>[t(f,{rounded:"lg",class:"pa-5",width:"400"},{default:s(()=>[t(H,{label:"Original",variant:"outlined",modelValue:e.current_word_to_check,"onUpdate:modelValue":l[7]||(l[7]=r=>e.current_word_to_check=r),readonly:!0},null,8,["modelValue"]),t(ee,{"validate-on":"submit lazy",onSubmit:ce(_.checkTranslation,["prevent"])},{default:s(()=>[t(H,{modelValue:e.current_user_input,"onUpdate:modelValue":l[8]||(l[8]=r=>e.current_user_input=r),"persistent-hint":!0,label:"Translation...",variant:"outlined",onKeyup:_e(_.checkTranslation,["enter"]),readonly:e.post_validation_lock,error:!e.is_user_input_correct,"error-messages":e.current_error_message,messages:e.current_message},null,8,["modelValue","onKeyup","readonly","error","error-messages","messages"])]),_:1},8,["onSubmit"]),t(F,{class:"align-center justify-center"},{default:s(()=>[t(O,{rounded:"lg",size:"large",class:"text-uppercase mt-1 my-button",text:"NEXT",onClick:_.getNextWord},null,8,["onClick"])]),_:1})]),_:1})]),_:1})])):p("",!0)]),_:1})]),_:1})]),_:1})):p("",!0),e.is_lesson_complete&&e.forgotten_words.length!==0?(i(),g(f,{key:3,elevation:"0",class:"w-100"},{default:s(()=>[t(L,null,{default:s(()=>[t(j,null,{default:s(()=>[u(" Forgotten words ")]),_:1}),t(P,null,{default:s(()=>[u(" Here are words for you to repeat to get all five stars next time! ")]),_:1})]),_:1})]),_:1})):p("",!0),e.is_lesson_complete&&e.forgotten_words.length!==0?(i(),g(f,{key:4,elevation:"0",class:"w-100","max-height":"400px"},{default:s(()=>[t(D,null,{default:s(()=>[t(se,{"fixed-header":!0,height:"300px"},{default:s(()=>[pe,a("tbody",null,[(i(!0),C(W,null,Y(e.forgotten_words,r=>(i(),C("tr",null,[a("td",fe,k(r),1),a("td",ye,k(e.word_to_translation_pairs.get(r)),1)]))),256))])]),_:1})]),_:1})]),_:1})):p("",!0)]),_:1}),t(h,{cols:"12",align:"end",justify:"center"},{default:s(()=>[!e.is_lesson_complete&&Object.keys(e.words).length!==0?(i(),g(O,{key:0,rounded:"lg",size:"large",class:"text-uppercase my-1 my-button",onClick:_.onCompleteClick},{default:s(()=>[u("complete")]),_:1},8,["onClick"])):p("",!0)]),_:1})]),_:1})]),_:1}),t(le,{modelValue:e.overlay,"onUpdate:modelValue":l[10]||(l[10]=r=>e.overlay=r),contained:!0,class:"align-center justify-center"},{default:s(()=>[t(f,{rounded:"lg",width:"360"},{default:s(()=>[t(L,null,{default:s(()=>[t(j,null,{default:s(()=>[ve]),_:1})]),_:1}),t(D,null,{default:s(()=>[a("div",we,[t(d,{icon:e.lesson_icon,style:{"font-size":"250px"},color:e.lesson_color},null,8,["icon","color"]),a("div",be,[u(k(e.success_percent)+" ",1),ke]),t(oe,{modelValue:e.success_percent,"onUpdate:modelValue":l[9]||(l[9]=r=>e.success_percent=r),color:"yellow-darken-3","half-increments":!0,readonly:!0},null,8,["modelValue"]),a("p",xe,[u(" Great job! "),Ve,u(" "+k(_.generateUserMessageOnLessonComplete()),1)])])]),_:1}),t(F,{class:"align-center justify-center"},{default:s(()=>[t(O,{onClick:_.onLessonComplete,class:"text-uppercase my-1 my-button",rounded:"lg",size:"large"},{default:s(()=>[u("done")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Me=re(he,[["render",Ce],["__scopeId","data-v-4938aa45"]]);export{Me as default};
